{"version":3,"names":[],"mappings":"","sources":["directives/fm-navbar-directive/fm-navbar-directive.js"],"sourcesContent":["(function() {\r\n    'use strict';\r\n\r\n    angular.module('fm').directive('fmNavbar', ['$location', '$rootScope', '$navlinksService', 'fmAuthtokenFactory', 'fmDataService', function ($location, $rootScope, $navlinksService, fmAuthtokenFactory, fmDataService) {\r\n\r\n      return {\r\n        restrict: 'E',\r\n        templateUrl: 'views/fm-navbar-view.html',\r\n        link: function (scope, elem, attrs) {\r\n\r\n          var w = $(window),\r\n              navbar = $('.navbar-sticky');\r\n\r\n          function headerBgScroll() {\r\n            var scroll = w.scrollTop(),\r\n                scrollTriggerDistance = 500;\r\n\r\n            if (scroll >= scrollTriggerDistance) {\r\n              navbar.addClass('navbar-slide-up');\r\n            }\r\n            else {\r\n              navbar.removeClass('navbar-slide-up');\r\n            }\r\n          }\r\n\r\n          w.on('scroll', headerBgScroll);\r\n\r\n          scope.navbarlinks = $navlinksService.getNavLinks();\r\n\r\n          scope.isAuthenticated = function () {\r\n            return fmAuthtokenFactory.isAuthenticated();\r\n          }\r\n\r\n          scope.logOut = function () {\r\n            fmAuthtokenFactory.removeToken();\r\n          }\r\n\r\n          // Menu modal\r\n          var menuModal = $('#fm-fund-menu-modal'),\r\n              menuModalButton = menuModal.find('.fm-fund-modal-close-button').hide(),\r\n              menuModalLinks = menuModal.find('.fm-fund-menu-modal-links');\r\n\r\n          // Eventhandlers\r\n          menuModal.on('webkitTransitionEnd transitionend', fadeInMenuModalButton);\r\n          menuModalLinks.on('click', navModalLinkClick);\r\n\r\n\r\n          function fadeInMenuModalButton() {\r\n            if (menuModal.hasClass('modal-open')) {\r\n              menuModalButton.show().addClass('flipInY');\r\n              menuModalLinks.addClass('links-open');\r\n            }\r\n            else {\r\n              resetMenuModal();\r\n            }\r\n          }\r\n\r\n          function resetMenuModal() {        \r\n            menuModalButton.removeClass('flipInY').hide();\r\n            menuModalLinks.removeClass('links-open');\r\n          }\r\n\r\n\r\n          function navModalLinkClick(event) {\r\n            event.preventDefault();\r\n            scope.closeMenuModal();\r\n          }\r\n\r\n\r\n          scope.openMenuModal = function () {\r\n            menuModal.addClass('modal-open');\r\n          };\r\n\r\n          scope.closeMenuModal = function () {\r\n            menuModalLinks.removeClass('links-open');\r\n            menuModal.removeClass('modal-open');    \r\n          };\r\n\r\n\r\n          // Search modal\r\n          var searchModal = $('#fm-fund-search-modal'),\r\n              searchField = searchModal.find('#fm-fund-modal-seach'),\r\n              inputGroup = searchModal.find('.fm-modal-inputgroup').hide(),\r\n              searchModalButton = searchModal.find('.fm-fund-modal-close-button').hide();\r\n\r\n          // Eventhandlers\r\n          window.addEventListener('keydown', function (event) {\r\n\r\n            if (event.altKey && event.keyCode == 83 && !searchModal.hasClass('modal-open')) {\r\n              scope.openSearchModal();\r\n            }\r\n\r\n            if (event.keyCode == 27 && searchModal.hasClass('modal-open')) {\r\n              scope.closeSearchModal();\r\n            }\r\n           \r\n          });\r\n\r\n          searchModal.on('webkitTransitionEnd transitionend', fadeInModalControls);\r\n          inputGroup.on('webkitAnimationEnd oanimationend msAnimationEnd animationend', setInputFocus);\r\n\r\n          function fadeInModalControls() {\r\n            if (searchModal.hasClass('modal-open')) {\r\n              searchModalButton.show().addClass('flipInY');\r\n              inputGroup.show().addClass('fadeIn');\r\n            }\r\n            else {\r\n              resetSearchModal();\r\n            }\r\n          }\r\n\r\n          function setInputFocus() {\r\n            searchField.focus();\r\n          }\r\n\r\n          function resetSearchModal() {\r\n            searchModalButton.removeClass('flipInY fadeInDown').hide();\r\n            inputGroup.removeClass('fadeIn').hide();\r\n            searchField.val('');\r\n\r\n            if (scope.search.title) {\r\n              scope.search.title = '';\r\n            }\r\n      \r\n          }\r\n\r\n          scope.openSearchModal = function () {\r\n            searchModal.addClass('modal-open');\r\n            \r\n            if (menuModal.hasClass('modal-open')) {\r\n              scope.closeMenuModal();\r\n            }\r\n          };\r\n\r\n          scope.closeSearchModal = function () {\r\n            searchModal.removeClass('modal-open');\r\n          };\r\n\r\n          scope.searchItems = [];\r\n\r\n          fmDataService.then(function (data) {\r\n            scope.funds = data.funds;\r\n            scope.newsitems = data.newsitems;\r\n            \r\n\r\n            for (var key in scope.funds) {\r\n              if (scope.funds.hasOwnProperty(key)) {\r\n                var fundItem = { title: scope.funds[key].name, type: 'fund'};\r\n                scope.searchItems.push(fundItem);\r\n              }\r\n            }\r\n\r\n            for (var key in scope.newsitems) {\r\n              if (scope.newsitems.hasOwnProperty(key)) {\r\n                var newsItem = { title: scope.newsitems[key].headline, type: 'news' };\r\n                scope.searchItems.push(newsItem);\r\n              }\r\n            }\r\n          });\r\n\r\n        }\r\n      }\r\n\r\n    }]);\r\n\r\n})();"],"file":"directives/fm-navbar-directive/fm-navbar-directive.js","sourceRoot":"/source/"}